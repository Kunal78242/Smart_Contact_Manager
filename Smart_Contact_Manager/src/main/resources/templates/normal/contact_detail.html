<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" 
      th:replace="~{normal/base::layout(~{::section})}"> <!-- FIXED: Added ~{} -->

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Details</title>
</head>

<body>

<section>

<div class="container mt-4" th:if="${contact}">
    <div class="card">
        <div class="card-body">
            
            <div class="text-center mb-4">
                <img th:src="@{'/img/' + ${contact.image}}" 
                     style="height: 120px; width: 120px; border-radius: 50%; object-fit: cover;" 
                     class="my_profile_picture" 
                     alt="profile photo">
                
                <h3 class="mt-3">
                    <span th:text="${contact.name}"></span>  
                    <span th:if="${contact.secondName != null and contact.secondName != ''}">
                        (<span th:text="${contact.secondName}"></span>)
                    </span>
                </h3>
                <p class="text-muted" th:text="${contact.work}"></p>
            </div>

            <div class="table-responsive">
                <table class="table table-bordered">
                    <thead class="thead-dark">
                        <tr>
                            <th scope="col" width="30%">Property</th>
                            <th scope="col" width="70%">Value</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <th scope="row">Contact ID</th>
                            <td>SCMUSER<span th:text="${contact.cId}"></span></td>
                        </tr>
                        
                        <tr>
                            <th scope="row">Email</th>
                            <td>
                                <a th:href="'mailto:' + ${contact.email}" th:text="${contact.email}"></a>
                            </td>
                        </tr>
                        
                        <tr>
                            <th scope="row">Phone</th>
                            <td>
                                <a th:href="'tel:' + ${contact.phone}" th:text="${contact.phone}"></a>
                            </td>
                        </tr>
                        
                        <tr>
                            <th scope="row">Work</th>
                            <td th:text="${contact.work}"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div th:if="${contact.description != null and contact.description != ''}" class="mt-4">
                <h5>Description:</h5>
                <div class="border p-3 rounded" th:utext="${contact.description}"></div>
            </div>

            <div class="container mt-4 text-center">
                <!-- FIXED: Changed c.cId to contact.cId -->
                <a th:href="@{'/user/delete/' + ${contact.cId}}" 
                   class="btn btn-danger btn-sm" 
                   onclick="return confirm('Are you sure you want to delete this contact?')">
                    Delete
                </a>
                
                <a th:href="@{'/user/update/' + ${contact.cId}}" 
                   class="btn btn-primary btn-sm ml-2">
                    Update
                </a>
                
                <a th:href="@{'/user/show-contacts/0'}" 
                   class="btn btn-secondary btn-sm ml-2">
                    Back to Contacts
                </a>
            </div>

        </div>
    </div>
</div>

<h1 class="text-center p-3 bg-danger text-white mt-4" th:unless="${contact}">
    You don't have permission to view this contact
</h1>

</section>

</body>
</html>
